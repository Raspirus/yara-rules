rule VOLEXITY_Apt_Malware_Charmingcypress_Openvpn_Configuration : CHARMINGCYPRESS FILE
{
	meta:
		description = "Detection for a .ovpn file used in a malicious VPN client on victim machines by CharmingCypress."
		author = "threatintel@volexity.com"
		id = "f39b2d7c-f0c5-5623-a114-02ba32469e59"
		date = "2023-10-17"
		modified = "2023-10-27"
		reference = "TIB-20231027"
		source_url = "https://github.com/volexity/threat-intel/blob/cb213e6d64022494a2ae7a9e65dfbf254a99b144/2024/2024-02-13 CharmingCypress/rules.yar#L262-L286"
		license_url = "https://github.com/volexity/threat-intel/blob/cb213e6d64022494a2ae7a9e65dfbf254a99b144/LICENSE.txt"
		logic_hash = "f4c5f13ac75504b14def9c37d3a41c6eea4c45845d4b54c50030b1f00691e4bf"
		score = 75
		quality = 80
		tags = "CHARMINGCYPRESS, FILE"
		hash1 = "d6d043973d8843a82033368c785c362f51395b1a1d475fa4705aff3526e15268"
		parent_hash = "31ca565dcbf77fec474b6dea07101f4dd6e70c1f58398eff65e2decab53a6f33"
		os = "all"
		os_arch = "all"
		scan_context = "file"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 9769
		version = 3

	strings:
		$remote = "remote-cert-tls server" ascii
		$ip = "Ip: "
		$tls = "<tls_auth>"

	condition:
		all of them
}