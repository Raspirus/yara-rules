import "pe"


rule DITEKSHEN_MALWARE_Win_Rustystealer : FILE
{
	meta:
		description = "Detect Rusty / Luca stealer"
		author = "ditekSHen"
		id = "af39f88c-e0df-51f6-bb11-f3a7231180d0"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L10620-L10643"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "e60e66360c8f97a31e75cd90a12519f75f3a672874fc985a8da1d4d02e185b4d"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$s1 = "EdgeMicrosoftedgechromiumChromium7star7StaramigoAmigobraveBrave" ascii
		$s2 = "BrowserchromeChromekometaKometaorbitumOrbitumsputnikSputniktorchTorchucozmediaUranuCozMediavivaldiVivaldiatom" ascii
		$s3 = ".kdbx.pdf.doc.docx.xls.xlsx.ppt.pptx.odt.odp\\logscx\\sensfiles.zip" ascii
		$s4 = "dumper.rs" ascii
		$s5 = "decryption_core.rs" ascii
		$s6 = "anti_emulation.rs" ascii
		$s7 = "discord.rs" ascii
		$s8 = /\\logscx\\(passwords_|cookies_|creditcards_)/ ascii
		$s9 = "VirtualBoxVBoxVMWareVMCountry" ascii
		$s10 = "New Log From ( /  )" ascii
		$s11 = "BrowserChromeKometaOrbitumSputnikTorchUranuCozMediaVivaldiAtomMail" ascii
		$s12 = "BrowserBraveSoftwareCentBrowserChedotChrome" ascii
		$s13 = "ChromeKometaOrbitumSputnikTorchUranuCozMediaVivaldi" ascii
		$s14 = "hostnameencryptedUsernameencryptedPasswordstruct" ascii
		$s15 = "encryptedPassword" fullword ascii
		$s16 = "AutoFill@~" fullword ascii

	condition:
		uint16(0)==0x5a4d and 6 of them
}