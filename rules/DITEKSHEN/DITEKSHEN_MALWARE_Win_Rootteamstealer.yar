rule DITEKSHEN_MALWARE_Win_Rootteamstealer : FILE
{
	meta:
		description = "Detects RootTeam infostealer"
		author = "ditekSHen"
		id = "3b57ff3e-09cf-52be-ac7f-45ee832d70ab"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L10419-L10435"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "d1693865253067527d58c980653d550b55d022d5a394b88090a958e5d5818143"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$x1 = "RootTeamStl" ascii
		$x2 = "Bot: https://t.me/rootteam_bot" ascii
		$x3 = "rootteam_bot" ascii
		$x4 = "Root Team" ascii
		$s1 = "-ldflags=\"-s -w -H windowsgui -X" ascii
		$s2 = "'RootTeamStl/vars." ascii
		$s3 = "{ Hostname string \"json:\\\"hostname\\\"\"; EncryptedUsername string \"json:\\\"encryptedUsername\\\"\"; EncryptedPassword string \"json:\\\"encryptedPassword\\\"\" }" ascii
		$s4 = "\\Program Files (x86)\\Steam\\config\\loginusers.vdf" ascii
		$s5 = /RootTeamStl\/managers\/(browser|coldwallets|discord|filegrabber|steam|userinformation)?/ ascii

	condition:
		uint16(0)==0x5a4d and (3 of ($x*) or (1 of ($x*) and 3 of ($s*)) or 4 of ($s*) or 5 of them )
}