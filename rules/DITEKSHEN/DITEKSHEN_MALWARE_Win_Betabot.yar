rule DITEKSHEN_MALWARE_Win_Betabot : FILE
{
	meta:
		description = "BetaBot payload"
		author = "ditekSHen"
		id = "377c500c-5727-5bea-ac46-cb69c868a607"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L1654-L1666"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "e594d01874ee622169d6708ddc6cfde7f1d26d2bea1604961dc860700e8a1d5d"
		score = 75
		quality = 73
		tags = "FILE"

	strings:
		$s1 = "__restart" fullword ascii
		$s2 = "%SystemRoot%\\SysWOW64\\tapi3.dll" fullword wide
		$s3 = "%SystemRoot%\\system32\\tapi3.dll" fullword wide
		$s4 = "publicKeyToken=\"6595b64144ccf1df\"" ascii
		$s5 = "VirtualProtectEx" fullword ascii

	condition:
		uint16(0)==0x5a4d and filesize <600KB and all of them
}