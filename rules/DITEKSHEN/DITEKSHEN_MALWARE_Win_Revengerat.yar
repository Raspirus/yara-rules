import "pe"


rule DITEKSHEN_MALWARE_Win_Revengerat : FILE
{
	meta:
		description = "RevengeRAT and variants payload"
		author = "ditekSHen"
		id = "7d725050-108c-54b5-978e-2dd2124f5b0f"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L1687-L1713"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "be9e50052f45b94d5995db723dd64d16a91c5ba0d3f589c018155c0cce45124f"
		score = 75
		quality = 75
		tags = "FILE"
		snort_sid = "920000-920002"

	strings:
		$l1 = "Lime.Connection" fullword ascii
		$l2 = "Lime.Packets" fullword ascii
		$l3 = "Lime.Settings" fullword ascii
		$l4 = "Lime.NativeMethods" fullword ascii
		$s1 = "GetAV" fullword ascii
		$s2 = "keepAlivePing!" fullword ascii wide
		$s3 = "Revenge-RAT" fullword ascii wide
		$s4 = "*-]NK[-*" fullword ascii wide
		$s5 = "RV_MUTEX" fullword ascii wide
		$s6 = "set_SendBufferSize" fullword ascii
		$s7 = "03C7F4E8FB359AEC0EEF0814B66A704FC43FB3A8" fullword ascii
		$s8 = "5B1EE7CAD3DFF220A95D1D6B91435D9E1520AC41" fullword ascii
		$s9 = "\\RevengeRAT\\" ascii
		$q1 = "Select * from AntiVirusProduct" fullword ascii wide
		$q2 = "SELECT * FROM FirewallProduct" fullword ascii wide
		$q3 = "select * from Win32_Processor" fullword ascii wide

	condition:
		uint16(0)==0x5a4d and ((1 of ($l*) and 3 of ($s*)) or ( all of ($q*) and 3 of ($s*)) or 3 of ($s*))
}