rule DITEKSHEN_MALWARE_Win_TOITOIN_Downloader : FILE
{
	meta:
		description = "Detects TOITOIN Downloader"
		author = "ditekSHen"
		id = "0282ea26-e381-5c9a-9dad-c90246d8add0"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L11161-L11172"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "d7e5e99c9266ec144152c3d1066e0e1a862f48ded17fab8f504192ca48219826"
		score = 75
		quality = 75
		tags = "FILE"
		clamav = "ditekSHen.MALWARE.Win.Trojan.TOITOIN"

	strings:
		$p1 = ":\\Trabalho_2023\\OFF_2023\\" ascii
		$s1 = { 20 2f 63 20 22 [6-15] 63 00 6d 00 64 00 00 00 6f 00 70 00 65 00 6e }
		$o1 = { 48 83 fa 10 72 34 48 8b 8d 10 ?? 00 00 48 ff c2 }

	condition:
		uint16(0)==0x5a4d and all of them
}