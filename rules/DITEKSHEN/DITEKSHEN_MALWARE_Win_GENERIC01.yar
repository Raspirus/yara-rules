import "pe"


rule DITEKSHEN_MALWARE_Win_GENERIC01 : FILE
{
	meta:
		description = "Detects known unamed malicious executables, mostly DLLs"
		author = "ditekSHen"
		id = "3c16df71-f2e2-591c-b377-7e5ed697d43f"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L4562-L4575"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "ddae979db5ddda772ca66a3d50e4b5479b16052ea002fd04fdbf295ce784e291"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$s1 = "\\wmkawe_%d.data" ascii
		$s2 = "\\resmon.resmoncfg" ascii
		$s3 = "ByPassUAC" fullword ascii
		$s4 = "rundll32.exe C:\\ProgramData\\Sandboxie\\SbieMsg.dll,installsvc" fullword ascii nocase
		$s5 = "%s\\SbieMsg." ascii
		$s6 = "Stupid Japanese" fullword ascii

	condition:
		uint16(0)==0x5a4d and 5 of them
}