import "pe"


rule DITEKSHEN_MALWARE_Win_Fatalrat : FILE
{
	meta:
		description = "Detects FatalRAT"
		author = "ditekSHen"
		id = "f9d0c5dd-ae69-512d-a260-01b9765e10eb"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L6110-L6128"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "fb7f6822aa4ef98e77670d276d06c9a37718bce38d32ce5b53fe67513b107fbe"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$x1 = "XXAcQbcXXfRSScR" fullword ascii
		$s1 = "CHROME_NO_DATA" fullword ascii
		$s2 = "CHROME_UNKNOW" fullword ascii
		$s3 = "-Thread running..." ascii
		$s4 = "InetCpl.cpl,ClearMyTracksByProcess" ascii nocase
		$s5 = "MSAcpi_ThermalZoneTemperature" ascii nocase
		$s6 = "taskkill /f /im rundll32.exe" fullword ascii nocase
		$s7 = "del /s /f %appdata%\\Mozilla\\Firefox" ascii nocase
		$s8 = "\\\\%s\\C$\\" ascii
		$s9 = "fnGetChromeUserInfo" fullword ascii
		$s10 = "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost" fullword ascii

	condition:
		uint16(0)==0x5a4d and ((1 of ($x*) and 3 of ($s*)) or 5 of ($s*))
}