rule DITEKSHEN_MALWARE_Win_Romcom_Loader : FILE
{
	meta:
		description = "Hunt for RomCom loader"
		author = "ditekShen"
		id = "49a5398a-e28d-51e2-90d5-479d815f9967"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L10309-L10325"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "7aef88aa9f201c3a1852d63b17c14e44c7c2a7dfe94a9bc77897a4aa0eb97486"
		score = 75
		quality = 75
		tags = "FILE"

	condition:
		uint16(0)==0x5a4d and pe.is_dll() and (pe.exports("DllCanUnloadNow") and pe.exports("DllGetClassObject") and pe.exports("DllRegisterServer") and pe.exports("DllUnregisterServer") and pe.exports("GetProxyDllInfo")) and for any fn in pe.export_details : (fn.forward_name contains "Dll")
}