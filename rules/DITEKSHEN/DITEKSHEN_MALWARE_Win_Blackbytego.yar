rule DITEKSHEN_MALWARE_Win_Blackbytego : FILE
{
	meta:
		description = "Detects BlackByte ransomware Go variants"
		author = "ditekSHen"
		id = "25431446-8cce-54cc-925d-5d9147344c6d"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L8884-L8904"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "b3e6a4a2f043293e8693cfbe1515681ce0616d98e2492732fc06a01a96309883"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$x1 = "BlackByteGO/_cgo_gotypes.go" fullword ascii
		$x3 = "BlackByteGO/" ascii nocase
		$s1 = ".Disconnect" ascii
		$s2 = ".OpenService" ascii
		$s3 = ".ListServices" ascii
		$s4 = ".Start" ascii
		$s5 = ".Encrypt" ascii
		$s6 = ".Decrypt" ascii
		$s7 = ".MustFindProc" ascii
		$s8 = ".QuoRem" ascii
		$s9 = "C:\\Windows\\regedit.exe" fullword wide

	condition:
		uint16(0)==0x5a4d and (1 of ($x*) or all of ($s*))
}