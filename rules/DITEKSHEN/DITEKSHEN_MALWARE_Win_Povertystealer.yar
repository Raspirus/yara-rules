rule DITEKSHEN_MALWARE_Win_Povertystealer : FILE
{
	meta:
		description = "Detects PovertyStealer"
		author = "ditekSHen"
		id = "a431b82a-81cb-51a9-b3a8-61d71f36a60e"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L10922-L10935"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "0d8a4dd1f3a9935935878840d19e16d91d240da776f99eb2dd3f12df96efa1d9"
		score = 75
		quality = 75
		tags = "FILE"
		clamav1 = "MALWARE.Win.Trojan.PovertyStealer"

	strings:
		$x1 = "Poverty is the parent of crime." ascii
		$s2 = "OperationSystem: %d:%d:%d" ascii
		$s3 = "ScreenSize: {lWidth=%d, lHeight=%d}" ascii
		$s4 = "VideoAdapter #%d: %s" ascii
		$s5 = "$d.log" fullword wide

	condition:
		(( uint16(0)==0x5a4d and (1 of ($x*) or all of ($s*))) or all of them )
}