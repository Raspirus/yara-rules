import "pe"


rule DITEKSHEN_MALWARE_Win_Blackhunt : FILE
{
	meta:
		description = "Detects BlackHunt ransomware"
		author = "ditekSHen"
		id = "4bdb26dd-a424-54a6-b313-e98bdf18cfce"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L11459-L11474"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "62e9bc505eff3e19ff0cdaf180e45e6d7917f0bec7cd9b007bee9fe1d9d09b66"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$s1 = /#BlackHunt_(Logs|BG|Icon|Public|Private|ID|ReadMe|Update)\.(txt|jpg|ico|key|hta)/ ascii wide
		$s2 = /-(biggame|noencrypt|netinfo|nospread)/ fullword wide
		$s3 = "/v \"*BlackHunt\" /t REG_SZ /d" wide
		$s4 = "/sc onstart /TN \"Windows Critical Update\" /TR \"'%s' %s\" /F" wide
		$s5 = "/v \"DisableChangePassword\" /t REG_DWORD /d" wide
		$s6 = "<span> %s </span>this ID (<span> %s </span>)" wide
		$s7 = "}div.header h1 span#hunter" wide
		$s8 = "BLACK_HUNT_MUTEX" fullword ascii

	condition:
		uint16(0)==0x5a4d and 4 of them
}