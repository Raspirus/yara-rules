import "pe"


rule DITEKSHEN_MALWARE_Win_Reverserat : FILE
{
	meta:
		description = "Detects ReverseRAT"
		author = "ditekSHen"
		id = "df13fc6c-025a-54db-809d-4f3c27b8aa7a"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L6495-L6514"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "87ab00a5588bfce04ec47a07b184fffe359e472ac8bf561b02a8b070edf2e014"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$pdb1 = "\\ReverseRat.pdb" ascii nocase
		$pdb2 = "\\ReverseRat\\obj\\" ascii nocase
		$s1 = "processCmd" fullword ascii
		$s2 = "CmdOutputDataHandler" fullword ascii
		$s3 = "sendingProcess" fullword ascii
		$s4 = "SetStartup" fullword ascii
		$s5 = "RunServer" fullword ascii
		$s6 = "_OutputDataReceived" ascii
		$s7 = { 63 00 6d 00 64 00 2e 00 65 00 78 00 65 00 
                00 03 0a 00 00 13 74 00 65 00 72 00 6d 00
                69 00 6e 00 61 00 74 00 65 00 00 09 65 00
                78 00 69 00 74 00 }

	condition:
		uint16(0)==0x5a4d and ((1 of ($pdb*) and 2 of ($s*)) or 5 of ($s*))
}