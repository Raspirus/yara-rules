rule DITEKSHEN_MALWARE_Win_Houdiniconfig : FILE
{
	meta:
		description = "Detects Houdini Trojan configurations"
		author = "ditekshen"
		id = "e4f974fe-731e-55a8-aa5f-068a1e62f54d"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/back-in-2017"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L11618-L11634"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "70a67c9a91d2f82184f1d7a5ea51de911a054dd4e38e2cc36f495ed59219afab"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$s1 = "install_name="
		$s2 = "nick_name="
		$s3 = "install_folder="
		$s4 = "reg_startup="
		$s5 = "startup_folder_startup="
		$s6 = "task_startup="
		$s7 = "injection="
		$s8 = "injection_process"

	condition:
		( uint16(0)==0x5a4d and 5 of them ) or ( all of them )
}