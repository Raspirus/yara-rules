import "pe"


rule DITEKSHEN_MALWARE_Linux_Kinsing : FILE
{
	meta:
		description = "Kinsing RAT payload"
		author = "ditekSHen"
		id = "b13d2c36-c8d3-5138-9e9a-8b5390a93c8d"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L1361-L1376"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "566eb7d1864e3a8088ad4f5d032d6d62a33080bbfc5c20c2520315cfc8146afc"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$s1 = "backconnect" ascii
		$s2 = "connectForSocks" ascii
		$s3 = "downloadAndExecute" ascii
		$s4 = "download_and_exec" ascii
		$s5 = "masscan" ascii
		$s6 = "UpdateCommand:" ascii
		$s7 = "exec_out" ascii
		$s8 = "doTask with type %s" ascii

	condition:
		uint16(0)==0x457f and 6 of them
}