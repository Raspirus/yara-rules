import "pe"


rule DITEKSHEN_MALWARE_Win_Genircbot : FILE
{
	meta:
		description = "Detects generic IRCBots"
		author = "ditekSHen"
		id = "e1faa1dd-bbf5-5208-97d6-a6e8597d39bc"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L7610-L7626"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "cc7f4599148c45fdf755c07530ae4846b7e283b5c1001c121f9ea05279997dc1"
		score = 75
		quality = 73
		tags = "FILE"

	strings:
		$s1 = "@login" ascii nocase
		$s2 = "PRIVMSG" fullword ascii
		$s3 = "JOIN" fullword ascii
		$s4 = "PING :" fullword ascii
		$s5 = "NICK" fullword ascii
		$s6 = "USER" fullword ascii
		$x1 = "irc.danger.net" fullword ascii nocase
		$x2 = "evilBot" fullword ascii nocase
		$x3 = "#evilChannel" fullword ascii nocase

	condition:
		uint16(0)==0x5a4d and ( all of ($s*) or 2 of ($x*))
}