import "pe"


rule DITEKSHEN_MALWARE_Win_Parallaxrat : FILE
{
	meta:
		description = "Detects ParallaxRAT"
		author = "ditekSHen"
		id = "e602b28f-ae5d-52af-b1c5-5c41776dd4c5"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L3311-L3328"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "7fd94dee44079b595b906f1687f44b51b8cebabbeb0900563b8d4fcc0e46bdd0"
		score = 75
		quality = 75
		tags = "FILE"
		clamav_sig = "MALWARE.Win.Trojan.ParallaxRAT"

	strings:
		$s1 = "[Clipboard End]" fullword wide
		$s2 = "[Ctrl +" fullword wide
		$s3 = "[Alt +" fullword wide
		$s4 = "Clipboard Start" wide
		$s5 = "(Wscript.ScriptFullName)" wide
		$s6 = "CSDVersion" fullword ascii
		$s7 = "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" fullword ascii
		$x1 = { 2e 65 78 65 00 00 84 00 00 4d 5a 90 00 }
		$x2 = "This program cannot be run in DOS mode" ascii

	condition:
		(( uint16(0)==0x5a4d and all of ($s*)) or all of them )
}