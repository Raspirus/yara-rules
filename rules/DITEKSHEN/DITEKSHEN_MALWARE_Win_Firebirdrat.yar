rule DITEKSHEN_MALWARE_Win_Firebirdrat : FILE
{
	meta:
		description = "Firebird/Hive RAT payload"
		author = "ditekSHen"
		id = "456ae70e-8004-5fb0-a4fd-ce7c0f4704f9"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L316-L339"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "1c24e924171db1b99a3b03764f4551b6f4b6b1c9c6147b49dbc0651e85e9040c"
		score = 75
		quality = 73
		tags = "FILE"
		clamav_sig = "MALWARE.Win.Trojan.Firebird-HiveRAT"

	strings:
		$id1 = "Firebird Remote Administration Tool" fullword wide
		$id2 = "Welcome to Firebird! Your system is currently being monitored" wide
		$id3 = "Hive Remote Administration Tool" fullword wide
		$id4 = "Welcome to Hive! Your system is currently being monitored" wide
		$s1 = "REPLACETHESEKEYSTROKES" fullword wide
		$s2 = "_ENABLE_PROFILING" fullword wide
		$s3 = ": KeylogSubject" wide
		$s4 = "Firebird.CommandHandler" fullword wide
		$s5 = "webcamenabled" fullword ascii
		$s6 = "screenlogs" fullword ascii
		$s7 = "encryptedconnection" fullword ascii
		$s8 = "monitoron" fullword ascii
		$s9 = "screenGrab" fullword ascii
		$s10 = "TCP_TABLE_OWNER_PID_ALL" fullword ascii
		$s11 = "de4fuckyou" fullword ascii

	condition:
		uint16(0)==0x5a4d and (1 of ($id*) or 7 of ($s*))
}