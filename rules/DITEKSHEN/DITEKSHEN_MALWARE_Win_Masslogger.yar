import "pe"


rule DITEKSHEN_MALWARE_Win_Masslogger : FILE
{
	meta:
		description = "MassLogger keylogger payload"
		author = "ditekSHen"
		id = "9181b89a-2ce8-59b6-9703-c01a8471b8d6"
		date = "2024-05-28"
		modified = "2024-05-28"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/yara/malware.yar#L905-L934"
		license_url = "https://github.com/ditekshen/detection/blob/2ddbbe14eea1f342bca2cfd09a643a40ae2fcaf6/LICENSE.txt"
		logic_hash = "7d8bbefa71a1eb20cd9d029bd516d6c37e39cfa053ed0617eace200d210d9b58"
		score = 75
		quality = 73
		tags = "FILE"

	strings:
		$s1 = "MassLogger v" ascii wide
		$s2 = "MassLogger Started:" ascii wide
		$s3 = "MassLogger Process:" ascii wide
		$s4 = "/panel/upload.php" wide
		$s5 = "ftp://" wide
		$s6 = "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}" fullword wide
		$s7 = "^(.*/)?([^/\\\\.]+/\\\\.\\\\./)(.+)$" fullword wide
		$s8 = "Bot Killer" ascii
		$s9 = "Keylogger And Clipboard" ascii
		$c1 = "costura.ionic.zip.reduced.dll.compressed" fullword ascii
		$c2 = "CHECKvUNIQUEq" fullword ascii
		$c3 = "HOOK/MEMORY6" fullword ascii
		$c4 = "Massfile" ascii wide
		$c5 = "Fz=[0-9]*'skips*" fullword ascii
		$c6 = ":=65535zO" fullword ascii
		$c7 = "!$!%!&!'!(!)!*!.!/!0!4!" fullword ascii
		$c8 = "5!9!:!<!>!@!E!G!J!K!L!N!O!P!`!" fullword ascii
		$c9 = "dllToLoad" fullword ascii
		$c10 = "set_CreateNoWindow" fullword ascii
		$c11 = "FtpWebRequest" fullword ascii
		$c12 = "encryptedUsername" fullword ascii
		$c13 = "encryptedPassword" fullword ascii

	condition:
		( uint16(0)==0x5a4d and 9 of ($c*)) or (5 of ($s*) or 9 of ($c*))
}