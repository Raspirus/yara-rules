rule R3C0NST_ATM_Malware_ATMITCH : FILE
{
	meta:
		description = "Detects ATM Malware ATMItch"
		author = "Frank Boldewin (@r3c0nst)"
		id = "4d7e9615-9db6-5fc7-b95e-b8c7b2c034a8"
		date = "2019-03-18"
		modified = "2019-03-18"
		reference = "https://github.com/fboldewin/YARA-rules/"
		source_url = "https://github.com/fboldewin/YARA-rules//blob/54e9e6899b258b72074b2b4db6909257683240c2/ATM.Malware.ATMItch.yar#L3-L14"
		license_url = "N/A"
		logic_hash = "4278cbcd8c465ba57b65a166e0bd48dcc73eae8660972478d3116bc0d73cf3c4"
		score = 75
		quality = 82
		tags = "FILE"

	strings:
		$STRING1 = "SCREEN and think what does you DO" nocase ascii wide
		$STRING2 = "Receive CASH UNIT info first, then LOOK on" nocase ascii wide
		$STRING3 = "Unknown command mnemonic, check it and repeat again" nocase ascii wide
		$STRING4 = "Catch some money, bitch!" nocase ascii wide

	condition:
		( uint16(0)==0x5A4D and 1 of them ) or (pe.imphash()=="655ad5439db0832c5a3f86d0a68ddaac")
}