
rule ELASTIC_Windows_Exploit_Perfusion_5Ab5Ddee : FILE MEMORY
{
	meta:
		description = "Detects Windows Exploit Perfusion (Windows.Exploit.Perfusion)"
		author = "Elastic Security"
		id = "5ab5ddee-e79b-4f1c-bd60-92793f14e490"
		date = "2024-02-28"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/7607ac6ed3bb869356a16d2f7488f6744c68b134/yara/rules/Windows_Exploit_Perfusion.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/7607ac6ed3bb869356a16d2f7488f6744c68b134/LICENSE.txt"
		hash = "7fdef25acb0d1447203b9768ae58a8e21db24816c602b160d105dab86ae34728"
		logic_hash = "490f3fc89cf78dbe82f1feb012a147a8d187612720efb6e1eb4e97720b26ee59"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c8d13213b20fc99dd71034ddae986c71f6e89f632655e88d5f9c8be1d72c6231"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "SYSTEM\\CurrentControlSet\\Services\\%ws\\Performance" wide
		$s2 = "Win32_Perf" wide
		$s3 = "CollectPerfData" wide
		$s4 = "%wsperformance_%d_%d_%d.dll" wide

	condition:
		all of them
}