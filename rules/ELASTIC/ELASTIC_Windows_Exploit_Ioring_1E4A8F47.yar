
rule ELASTIC_Windows_Exploit_Ioring_1E4A8F47 : FILE MEMORY
{
	meta:
		description = "Detects Windows Exploit Ioring (Windows.Exploit.IoRing)"
		author = "Elastic Security"
		id = "1e4a8f47-0c04-4219-bc51-03ed0078d8a9"
		date = "2024-02-28"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/7607ac6ed3bb869356a16d2f7488f6744c68b134/yara/rules/Windows_Exploit_IoRing.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/7607ac6ed3bb869356a16d2f7488f6744c68b134/LICENSE.txt"
		hash = "ba2bd270bf3f312dfa3f77f0716edb634c90506c87f82c04aee09445d18738eb"
		logic_hash = "cbbea9a60bde13356ce88cd96aacaa02a3c99f4ae0b48c4ba84b72528a3d6b91"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a9048bd34f6dd5b7da283ff23397fa22802049fdce15915ea023b27b9b825d30"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = { 5C 00 5C 00 2E 00 5C 00 70 00 69 00 70 00 65 00 5C 00 69 00 6F 00 72 00 69 00 6E 00 67 00 5F 00 6F 00 75 00 74 00 }
		$s2 = "ioring_read" wide nocase
		$s3 = "ioring_write" wide nocase
		$s4 = "IoRing->RegBuffers" nocase

	condition:
		2 of them
}