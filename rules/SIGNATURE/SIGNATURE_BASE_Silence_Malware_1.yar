import "pe"


rule SIGNATURE_BASE_Silence_Malware_1 : FILE
{
	meta:
		description = "Detects malware sample mentioned in the Silence report on Securelist"
		author = "Florian Roth (Nextron Systems)"
		id = "f932e3fe-a2d7-55b7-b581-88c0ed45723e"
		date = "2017-11-01"
		modified = "2023-12-05"
		reference = "https://securelist.com/the-silence/83009/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/yara/apt_silence.yar#L13-L38"
		license_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/LICENSE"
		logic_hash = "b88795268c080fe19f7e185d1542b520616fe6c00bae23a99981aa1ee8abacb3"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "f24b160e9e9d02b8e31524b8a0b30e7cdc66dd085e24e4c58240e4c4b6ec0ac2"

	strings:
		$x1 = "adobeudp.exe" fullword wide
		$x2 = "%s\\adobeudp.exeZone.Identifier" fullword ascii
		$x3 = "%s\\igfxpers_%08x.exe" fullword ascii
		$x4 = "%s\\adobeudp.exe" fullword ascii
		$s1 = "SoftWare\\MicroSoft\\Windows\\CurrentVersion\\Run" fullword ascii
		$s2 = "Copyright (C)  1999 - 2017" fullword wide
		$s3 = "%sget.php?name=%x" fullword ascii
		$s4 = "VNASSRUNXYC" fullword wide

	condition:
		uint16(0)==0x5a4d and filesize <200KB and (pe.imphash()=="e03edb9bd7cbe200dc59f361db847f8a" or 1 of ($x*) or 3 of them )
}