rule SIGNATURE_BASE_ATM_Malware_Dispenserxfs_1 : FILE
{
	meta:
		description = "Detects ATM Malware DispenserXFS"
		author = "@Xylit0l @r3c0nst / Modified by Florian Roth"
		id = "7c06102c-93d3-52f4-8c25-430f6f7a601f"
		date = "2019-02-27"
		modified = "2023-01-06"
		reference = "https://twitter.com/r3c0nst/status/1100775857306652673"
		source_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/yara/crime_atm_dispenserxfs.yar#L4-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/LICENSE"
		logic_hash = "3c7331b29f7cd8c40f99e235664f86361ba99c9ca0092c1cfb6faf367764303e"
		score = 80
		quality = 85
		tags = "FILE"

	strings:
		$xc1 = { 68 FF FF 00 00 68 60 EA 00 00 6A 10 }
		$s1 = "\\dispenserXFS.pdb" ascii
		$s3 = "C:\\xfsasdf.txt" fullword ascii
		$s4 = "Injected mxsfs killer into %d." fullword ascii
		$s5 = "Waiting for freeze msxfs processes..." fullword ascii

	condition:
		uint16(0)==0x5A4D and (1 of them or pe.imphash()=="617e037ae26d1931818db0790fb44bfe")
}