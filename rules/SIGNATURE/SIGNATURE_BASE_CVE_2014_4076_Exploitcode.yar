
rule SIGNATURE_BASE_CVE_2014_4076_Exploitcode : CVE_2014_4076 FILE
{
	meta:
		description = "Detects an exploit code for CVE-2014-4076"
		author = "Florian Roth (Nextron Systems)"
		id = "83563dea-63d9-58a9-82ed-275455122571"
		date = "2018-04-04"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/yarGen"
		source_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/yara/exploit_cve_2014_4076.yar#L2-L18"
		license_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/LICENSE"
		logic_hash = "96b8743de8b3968d64b74af93f5e61574a3b31d33df6d51e944b4f02c7b9723e"
		score = 75
		quality = 85
		tags = "CVE-2014-4076, FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "44690af85efef2db04c7e8cba7ca0d0e53be1a1432a339570a7d26eec860b8ee"

	strings:
		$x1 = "[+] Created a new cmd.exe process" fullword ascii
		$x2 = "[+] Modified shellcode" fullword ascii
		$x3 = "[*] Spawning SYSTEM shell..." fullword ascii
		$x4 = "[*] MS14-070 (CVE-2014-4076) x86" fullword ascii

	condition:
		uint16(0)==0x5a4d and filesize <100KB and 1 of them
}