import "pe"


rule SIGNATURE_BASE_Kaspermalware_Oct17_1 : FILE
{
	meta:
		description = "Detects Kasper Backdoor"
		author = "Florian Roth (Nextron Systems)"
		id = "7201d8ee-50ee-5a5c-a5b8-ee36c78b0d6e"
		date = "2017-10-24"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/yara/crime_kasper_oct17.yar#L13-L30"
		license_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/LICENSE"
		logic_hash = "15758407fb3039f1453f13d579d7df9525645e4717078f6b1fa482ab335e3a56"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "758bdaf26a0bd309a5458cb4569fe1c789cf5db087880d6d1676dec051c3a28d"

	strings:
		$x1 = "\\Release\\kasper.pdb" ascii
		$x2 = "C:\\D@oc@um@en@ts a@nd Set@tings\\Al@l Users" wide

	condition:
		uint16(0)==0x5a4d and filesize <7000KB and (pe.imphash()=="2bceb64cf37acd34bc33b38f2cddfb61" or 1 of them )
}