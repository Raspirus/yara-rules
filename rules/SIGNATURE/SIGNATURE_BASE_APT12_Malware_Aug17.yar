import "pe"


rule SIGNATURE_BASE_APT12_Malware_Aug17 : FILE
{
	meta:
		description = "Detects APT 12 Malware"
		author = "Florian Roth (Nextron Systems)"
		id = "6c9cd68f-b839-5c99-a9f5-14c2d8a28bec"
		date = "2017-08-30"
		modified = "2023-12-05"
		reference = "http://blog.macnica.net/blog/2017/08/post-fb81.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/yara/apt_apt12_malware.yar#L13-L25"
		license_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/LICENSE"
		logic_hash = "0766376689540680f8db699f64aa89fc32ddef619a74864eb816c598b8d08c8a"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "dc7521c00ec2534cf494c0263ddf67ea4ba9915eb17bdc0b3ebe9e840ec63643"
		hash2 = "42da51b69bd6625244921a4eef9a2a10153e012a3213e8e9877cf831aea3eced"

	condition:
		( uint16(0)==0x5a4d and pe.imphash()=="9ba915fd04f248ad62e856c7238c0264")
}