rule SIGNATURE_BASE_KHRAT_Malware : FILE
{
	meta:
		description = "Detects an Imphash of KHRAT malware"
		author = "Florian Roth (Nextron Systems)"
		id = "3e6a5aca-9898-5864-8974-ca4adf272893"
		date = "2017-08-31"
		modified = "2023-12-05"
		reference = "https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/yara/apt_khrat.yar#L13-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/LICENSE"
		logic_hash = "cfc1a9fb4dbec4deb70616ab7c4cce3cf56429f61fd36f78245621527d011e20"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "53e27fd13f26462a58fa5587ecd244cab4da23aa80cf0ed6eb5ee9f9de2688c1"

	condition:
		uint16(0)==0x5a4d and filesize <100KB and pe.imphash()=="6a8478ad861f98f8428a042f74de1944"
}