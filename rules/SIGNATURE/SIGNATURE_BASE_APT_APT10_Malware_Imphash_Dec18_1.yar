rule SIGNATURE_BASE_APT_APT10_Malware_Imphash_Dec18_1 : FILE
{
	meta:
		description = "Detects APT10 malware based on ImpHashes"
		author = "Florian Roth (Nextron Systems)"
		id = "2de195a3-63a4-50ac-a83d-ab0db0f784bf"
		date = "2018-12-28"
		modified = "2023-12-05"
		reference = "AlienVault OTX IOCs - statistical sample analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/yara/apt_apt10.yar#L1390-L1406"
		license_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/LICENSE"
		logic_hash = "d6e2f23f3809e7a7064bfe4859db3480454a9c8b21ffac2e1e8b7b8a8906de93"
		score = 75
		quality = 85
		tags = "FILE"

	condition:
		uint16(0)==0x5a4d and filesize <6000KB and (pe.imphash()=="0556ff5e5f8744bff47d4921494ba46d" or pe.imphash()=="cb1194123f68a68eb14552c085b620ce" or pe.imphash()=="efad9ff8c0d2a6419bf1dd970bcd806d" or pe.imphash()=="7a861cd9c495e1d950a43cb708a22985" or pe.imphash()=="a5d0545030be75a421529c2b0be6c4bd" or pe.imphash()=="94491f4a812b0297419dc888aa4fd2a5")
}