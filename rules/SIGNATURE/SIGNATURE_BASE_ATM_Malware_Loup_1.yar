
rule SIGNATURE_BASE_ATM_Malware_Loup_1 : FILE
{
	meta:
		description = "Detects ATM Malware Loup"
		author = "Frank Boldewin (@r3c0nst)"
		id = "2215a93f-d854-5f9b-b5cd-53962c45db08"
		date = "2020-08-17"
		modified = "2023-12-05"
		reference = "https://twitter.com/r3c0nst/status/1295275546780327936"
		source_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/yara/crime_atm_loup.yar#L3-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/LICENSE"
		hash = "6c9e9f78963ab3e7acb43826906af22571250dc025f9e7116e0201b805dc1196"
		logic_hash = "5068c3f27cf821f512fb9a473d2bd45066d550f30fbc26f0cbebbe103e6f4ccb"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$String1 = "C:\\Users\\muham\\source\\repos\\loup\\Debug\\loup.pdb" ascii
		$String2 = "CurrencyDispenser1" ascii
		$Code = {50 68 C0 D4 01 00 8D 4D E8 51 68 2E 01 00 00 0F B7 55 08 52 E8}

	condition:
		uint16(0)==0x5A4D and filesize <100KB and all of ($String*) and $Code
}