import "pe"


rule SIGNATURE_BASE_APT15_Malware_Mar18_Msexchangetool : FILE
{
	meta:
		description = "Detects malware from APT 15 report by NCC Group"
		author = "Florian Roth (Nextron Systems)"
		id = "81b826b6-8c2e-5a8a-a626-9515d40dbbb0"
		date = "2018-03-10"
		modified = "2023-12-05"
		reference = "https://goo.gl/HZ5XMN"
		source_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/yara/apt_apt15.yar#L89-L106"
		license_url = "https://github.com/Neo23x0/signature-base/blob/6b8e2a00e5aafcfcfc767f3f53ae986cf81f968a/LICENSE"
		logic_hash = "4e9e29bc69383ab6248241622394afddde6e18032ed6e2b64575362773f25a94"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "16b868d1bef6be39f69b4e976595e7bd46b6c0595cf6bc482229dbb9e64f1bce"

	strings:
		$s1 = "\\Release\\EWSTEW.pdb" ascii
		$s2 = "EWSTEW.exe" fullword wide
		$s3 = "Microsoft.Exchange.WebServices.Data" fullword ascii
		$s4 = "tmp.dat" fullword wide
		$s6 = "/v or /t is null" fullword wide

	condition:
		uint16(0)==0x5a4d and filesize <40KB and all of them
}